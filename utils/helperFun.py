import uuid
from prettytable import PrettyTable

#Write parsed data to file
def write_results_to_file(data):
	if data[0]['type'] == "PE":
		file_name = uuid.uuid4().hex
		header = PrettyTable(['type', 'magic', 'machine', 'time_stamp'])
		header.padding_width=1
		header.add_row([data[0]['type'], data[0]['magic'], data[0]['machine'], data[0]['time_stamp']])

		hashes = PrettyTable(['imphash', 'md5', 'sha-1', 'sha-256'])
		hashes.padding_width=1
		hashes.add_row([data[1]['imphash'], data[1]['md5'], data[1]['sha-1'], data[1]['sha-256']])

		sections = PrettyTable(['Section name'])
		for d in data[2].values():
			sections.add_row([d])

		imports = PrettyTable(['lib', 'import'])
		imports.padding_width=1
		for i in range(0, len(data[3])):
			for imp in data[3][i]['imports']:
				imports.add_row([data[3][i]['dll'], imp])

		symbols = PrettyTable(['lib', 'import'])
		for s in data[4]:
			symbols.add_row([s])
		with open('output/'+file_name+'.txt', 'w') as output_file:
			output_file.write(str(header))
			output_file.write(str(hashes))
			output_file.write(str(sections))
			output_file.write(str(imports))
			output_file.write(str(symbols))
		return None

	elif data[0]['type'] == "ELF":
		file_name = uuid.uuid4().hex


	elif data[0]['type'] == "MACH-O":
		file_name = uuid.uuid4().hex

	elif data[0]['type'] == "DEX":
		file_name = uuid.uuid4().hex

